
config("flatbuffers_config") {
  include_dirs = [
    "//third_party/google/flatbuffers/include",
  ]
}

static_library("flatbuffers") {
  sources = [
    "//third_party/google/flatbuffers/src/idl_parser.cpp",
    "//third_party/google/flatbuffers/src/idl_gen_text.cpp",
  ]

  cflags = [
    "/wd4702", # Unreachable code.
  ]

  configs += [
    "//build/config/compiler/${compiler}:exceptions",
  ]

  all_dependent_configs = [
    ":flatbuffers_config",
  ]
}

tool_executable("flatc") {
  sources = [
    "//third_party/google/flatbuffers/src/flatc.cpp",
    "//third_party/google/flatbuffers/src/idl_gen_cpp.cpp",
    "//third_party/google/flatbuffers/src/idl_gen_fbs.cpp",
    "//third_party/google/flatbuffers/src/idl_gen_general.cpp",
    "//third_party/google/flatbuffers/src/idl_gen_go.cpp",
    "//third_party/google/flatbuffers/src/idl_gen_text.cpp",
    "//third_party/google/flatbuffers/src/idl_parser.cpp",
  ]

  cflags = [
    "/wd4702", # Unreachable code.
  ]

  configs += [
    ":flatbuffers_config",
  ]
}
